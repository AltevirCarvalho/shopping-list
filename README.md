# Shopping List

**Note:** This is a work in progress.

Shopping List is a series of Offline First demo apps, each built using a different stack. These demo apps cover:

* Progressive Web Apps
* Hybrid mobile apps
* Native mobile apps
* Desktop apps

## Purposes

These demo apps will each serve multiple purposes:

* Reference Implementations
* Live Demos
* Tutorials
* Workshops
* [Developer Journeys](https://developer.ibm.com/code/journey/)

## Features

Shopping List is a simple demo app, with a limited feature set. Here is a list of features written as user stories grouped by Epic:

* Planning
  * As a \<person planning to shop for groceries\>, I want to \<create a shopping list\> so that \<I can add items to this shopping list\>.
  * As a \<person planning to shop for groceries\>, I want to \<add an item to my shopping list\> so that \<I can remember to buy that item when I am at the grocery store later\>.
  * As a \<person planning to shop for groceries\>, I want to \<remove an item from my shopping list\> so that \<I can change my mind on what to buy when I am at the grocery store later\>.
* Shopping
  * As a \<person shopping for groceries\>, I want to \<view items on my shopping list\> so that \<I can remember what items to buy\>.
  * As a \<person shopping for groceries\>, I want to \<add an item to my shopping list\> so that \<I can remember to buy that item\>.
  * As a \<person shopping for groceries\>, I want to \<remove an item from my shopping list\> so that \<I can change my mind on what to buy\>.
  * As a \<person shopping for groceries\>, I want to \<check off an item on my shopping list\> so that \<I can keep track of what items I have bought\>.
* Offline First
  * As a \<person shopping for groceries\>, I want to \<have the app installed on my device\> so that \<I can continue to utilize my shopping list when no internet connection is available\>.
  * As a \<person shopping for groceries\>, I want to \<have my shopping list stored locally on my device\> so that \<I can continue to utilize my shopping list when no internet connection is available\>.
  * As a \<person shopping for groceries\>, I want to \<sync my shopping list with the cloud\> so that \<I can manage and utilize my shopping list on multiple devices\>.
* Multi-User / Multi-Device
  * As a \<new user\>, I want to \<sign up for the app\> so that \<I can use the app\>.
  * As an \<existing user\>, I want to \<sign in to the app\> so that \<I can use the app\>.
  * As an \<existing user\>, I want to \<sign out of the app\> so that \<I can protect my privacy\>.
* Geolocation
  * As a \<person planning to shop for groceries\>, I want to \<associate a shopping list with a grocery store\> so that \<I can be notified of this shopping list when I am physically at that grocery store\>.
  * As a \<person associating a shopping list with a physical store\>, I want to \<access previously-used locations\> so that \<I can quickly find the physical store for which I am searching\>.
  * As a \<person shopping for groceries\>, I want to \<be notified of a shopping list when I am physically at the grocery store associated with that shopping list\> so that \<I can quickly find the shopping list for my current context\>.

## Implementations

### Vanilla JS and PouchDB

![Progressive Web App](img/pwa-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![PouchDB](img/pouchdb-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-vanillajs-pouchdb

### Polymer and PouchDB

![Progressive Web App](img/pwa-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![Polymer](img/polymer-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![PouchDB](img/pouchdb-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-polymer-pouchdb

### React and PouchDB

![Progressive Web App](img/pwa-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![React](img/react-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![PouchDB](img/pouchdb-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-react-pouchdb

### Preact and PouchDB

![Progressive Web App](img/pwa-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![Preact](img/preact-logo.jpg)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![PouchDB](img/pouchdb-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-preact-pouchdb

### Vue.js and PouchDB

![Progressive Web App](img/pwa-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![Vue.js](img/vuejs-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![PouchDB](img/pouchdb-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-vuejs-pouchdb

### Ember.js and PouchDB

![Progressive Web App](img/pwa-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![Ember.js](img/emberjs-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![PouchDB](img/pouchdb-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-emberjs-pouchdb

### React Native and PouchDB

![React Native](img/react-native-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![PouchDB](img/pouchdb-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-react-native-pouchdb

### React Native and Cloudant Sync

![React Native](img/react-native-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![Cloudant Sync](img/cloudant-sync-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-react-native-cloudant-sync

### Ionic and PouchDB

![Ionic](img/ionic-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![PouchDB](img/pouchdb-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-ionic-pouchdb

### Ionic and Cloudant Sync

![Ionic](img/ionic-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![Cloudant Sync](img/cloudant-sync-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-ionic-cloudant-sync

### Cordova and PouchDB

![Cordova](img/cordova-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![PouchDB](img/pouchdb-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-cordova-pouchdb

### Cordova and Cloudant Sync

![Cordova](img/cordova-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![Cloudant Sync](img/cloudant-sync-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-cordova-cloudant-sync

### Swift and Cloudant Sync

![Swift](img/swift-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![Cloudant Sync](img/cloudant-sync-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-swift-cloudant-sync

### Kotlin and Cloudant Sync

![Kotlin](img/kotlin-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![Cloudant Sync](img/cloudant-sync-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-kotlin-cloudant-sync

### Electron and PouchDB

![Electron](img/electron-logo.png)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;![PouchDB](img/pouchdb-logo.png)

GitHub Repository:  
https://github.com/ibm-watson-data-lab/shopping-list-electron-pouchdb

## Interoperability

Implementations of the Shopping List demo app share a data model. This allows the demo apps to be interoperable with one another. For example, a user could plan a shopping trip with a desktop app built using Electron and PouchDB. The same user could then use a native app built using Kotlin and Cloudant Sync while shopping for groceries. Much of the design of this data model is inspired by the [CouchDB Best Practices](https://ehealthafrica.github.io/couchdb-best-practices/) collection from eHealth Africa.

### Shopping List Example

```javascript
{
  "_id": "list:cj6mj1zfj000001n1ugjfkj33",
  "type": "list",
  "version": 1,
  "title": "Groceries",
  "checked": false,
  "createdAt": "2017-08-21T18:40:00.000Z",
  "updatedAt": "2017-08-21T18:40:00.000Z"
}
```

Notes:

* `_id`: Unique identifier for the document. Generated from the following values, separated by colons:
  * Document type (`list`).
  * [Collision-resistant ID (cuid)](https://usecuid.org/).
* `type`: Document type (will always have a value of `list` for a shopping list).
* `version`: Document schema version.
* `title`: User-generated title for the shopping list.
* `checked`: Has this shopping list been fully checked off?
* `createdAt`: Date and time at which the document was created. Expressed as a simplified extended ISO format in zero UTC offset (which can be generated in JavaScript with `new Date().toISOString()`).
* `updatedAt`: Date and time at which the document was last updated. Expressed as a simplified extended ISO format in zero UTC offset.

### Shopping List Item Example

```javascript
{
  "_id": "list:cj6mj1zfj000001n1ugjfkj33:item:cj6mn7e36000001p9n14fgk6s",
  "type": "item",
  "version": 1,
  "title": "Mangos",
  "checked": false,
  "createdAt": "2017-08-21T18:43:00.000Z",
  "updatedAt": "2017-08-21T18:43:00.000Z"
}
```

Notes:

* `_id`: Unique identifier for the document. Generated from the following values, separated by colons:
  * Parent document type (`list`).
  * [Collision-resistant ID (cuid)](https://usecuid.org/) of the parent document.
  * Document type (`item`).
  * [Collision-resistant ID (cuid)](https://usecuid.org/).
* `type`: Document type (will always have a value of `item` for a shopping list item).
* `version`: Document schema version.
* `title`: User-generated title for the shopping list item.
* `checked`: Has this shopping list item been checked off?
* `createdAt`: Date and time at which the document was created. Expressed as a simplified extended ISO format in zero UTC offset (which can be generated in JavaScript with `new Date().toISOString()`).
* `updatedAt`: Date and time at which the document was last updated. Expressed as a simplified extended ISO format in zero UTC offset.

The built-in `_all_docs` view can be used to query a shopping list and all of its list items together:

```javascript
{
  "include_docs": true,
  "startkey": "list:cj6mj1zfj000001n1ugjfkj33",
  "endkey": "list:cj6mj1zfj000001n1ugjfkj33:\ufff0"
}
```

### Map Feature Example

Map features are derived from OpenStreetMap's [Nominatim](http://wiki.openstreetmap.org/wiki/Nominatim) search tool and are used for associating a shopping list with a geolocation. The following example is derived from the search:

```
http://nominatim.openstreetmap.org/search/Healthy%20Living%20Vermont?format=json&addressdetails=1&namedetails=1
```

```javascript
{
  "_id": "map-feature:77309276",
  "type": "map-feature",
  "version": 1,
  "createdAt": "2017-08-21T18:40:00.000Z",
  "updatedAt": "2017-08-21T18:40:00.000Z",
  "nominatim": {
    "place_id": "77309276",
    "licence": "Data © OpenStreetMap contributors, ODbL 1.0. http://www.openstreetmap.org/copyright",
    "osm_type": "way",
    "osm_id": "30729839",
    "boundingbox": [
      "44.4625931",
      "44.4631202",
      "-73.1803907",
      "-73.1795354"
    ],
    "lat": "44.46282415",
    "lon": "-73.1799710198028",
    "display_name": "Healthy Living, Dorset Street, South Burlington, Chittenden County, Vermont, 05406, United States of America",
    "class": "shop",
    "type": "supermarket",
    "importance": 0.311,
    "icon": "http://nominatim.openstreetmap.org/images/mapicons/shopping_supermarket.p.20.png",
    "address": {
      "supermarket": "Healthy Living",
      "road": "Dorset Street",
      "city": "South Burlington",
      "county": "Chittenden County",
      "state": "Vermont",
      "postcode": "05406",
      "country": "United States of America",
      "country_code": "us"
    },
    "namedetails": {
      name: "Healthy Living"
    }
  }
}
```

### Geolocation Context Example

A geolocation context is used to notify the user when the geolocation capability of their device has indicated that they are near a map feature associated with a shopping list. This provides the user with quick access to the shopping list for their current geographic context.

```javascript
{
  "_id": "geo-context:drguywpyxp4t:cj6mrfiv2000001n4gfykixw3",
  "type": "geo-context",
  "version": 1,
  "list": "cj6mj1zfj000001n1ugjfkj33",
  "mapFeature": "77309276",
  "notified": false,
  "createdAt": "2017-08-21T18:57:00.000Z",
  "updatedAt": "2017-08-21T18:57:00.000Z"
}
```

Notes:

* `_id`: Unique identifier for the document. Generated from the following values, separated by colons:
  * Document type (`geo-context`).
  * Geohash of the `nominatim.lat` and `nominatim.lon` values from the associated map feature at a precision of 12 (which can be generated in JavaScript using the [`latlon-geohash`](https://www.npmjs.com/package/latlon-geohash) module).
  * [Collision-resistant ID (cuid)](https://usecuid.org/).
* `type`: Document type (will always have a value of `geo-context` for a geolocation context item).
* `version`: Document schema version.
* `list`: Identifier for the shopping list associated with the geolocation context.
* `mapFeature`: Identifier for the map feature (e.g. grocery store) associated with the geolocation context.
* `notified`: Has a notification already been sent for this geolocation context?
* `createdAt`: Date and time at which the document was created. Expressed as a simplified extended ISO format in zero UTC offset (which can be generated in JavaScript with `new Date().toISOString()`).
* `updatedAt`: Date and time at which the document was last updated. Expressed as a simplified extended ISO format in zero UTC offset.

The built-in `_all_docs` view can be used to query for geolocation contexts near the current geolocation coordinates of the device (the value `drguyw` below is the geohash of the user's location at a precision of 6, or ±0.61 km):

```javascript
{
  "include_docs": true,
  "startkey": "geo-context:drguyw",
  "endkey": "geo-context:drguyw\ufff0"
}
```

The following map function can be used to "join" a shopping list with its associated map feature using the [linked documents](http://docs.couchdb.org/en/2.0.0/couchapp/views/joins.html#linked-documents) feature of CouchDB and its variants:

```javascript
function map(doc) {
  if (doc.type && doc.type == "geo-context" && doc.list) {
    const listId = "list:" + doc.list;
    emit(listId, { _id: listId });
    if (doc.mapFeature) {
      emit(listId, { _id: "map-feature:" + doc.mapFeature });
    }
  }
}
```

The view generated from the above map function can then be used to query a shopping list and its associated map feature:

```javascript
{
  "include_docs": true,
  "key": "list:cj6mj1zfj000001n1ugjfkj33"
}
```
